{"version":3,"names":[],"mappings":"","sources":["templates/blocks/filter/filter.js"],"sourcesContent":["$(document).ready(function(){\r\n    // var def_value = [],\r\n    //     len = $(\".select-wrap\").length;\r\n    // for(var i=0;i<len;i++){\r\n    //     def_value[i] = $(\".select-wrap\").eq(i).find(\"input[type='hidden']\").val();\r\n    // }\r\n\r\n    $(document).on('click', '.select-text', function(){\r\n        $(\".select-wrap\").not($(this).closest(\".select-wrap\")).removeClass(\"open\");\r\n        $(this).closest(\".select-wrap\").toggleClass(\"open\");\r\n    });\r\n   \r\n    $(document).on('click', '.checkItem', function(){\r\n        var list_body_name = $(this).closest(\"ul\").attr(\"data-name\"),\r\n            parent = $(this).closest(\".select-wrap\").find(\".select-text\"),\r\n            parent_input = $(this).closest(\".select-wrap\").find(\".select-text input\"),\r\n            parent_text = $(this).closest(\".select-wrap\").find(\".select-text span\"),\r\n            parent_wrap = $(this).closest(\".select-wrap\"),\r\n            this_value = $(this).val(),\r\n            _this = $(this),\r\n            item = _this.closest(\"li\"), \r\n            item_index = item.index(),\r\n            parent_list,\r\n            parent_items,\r\n            filterItem_index = $(this).closest(\".filterItem\").index();\r\n\r\n            parent.css(\"border-color\", \"#445f87\")\r\n            // parent_input.val(this_value);\r\n            // parent_text.html(this_value);\r\n\r\n        /* находим родительский dropdown блок и его дочерние li */\r\n        $(\".dropdown ul\").each(function(){\r\n            if ($(this).attr(\"data-name\") == list_body_name){\r\n                parent_list = $(this);\r\n                parent_items = parent_list.children(\"li\");\r\n            }\r\n        });\r\n\r\n        if (item.is(\".allItem\")){\r\n            var all_item = item;\r\n            if (all_item.is(\".selected\")){\r\n                parent_list.find(\"li\").removeClass(\"selected\");\r\n                parent_list.find(\".checkItem\").prop(\"checked\", false);\r\n                parent.removeAttr('style');\r\n                parent_wrap.removeClass(\"open\");\r\n                // parent_input.val(def_value[parent_num]);\r\n                // parent_text.html(def_value[parent_num]);\r\n            }else{\r\n                parent_list.find(\"li\").addClass(\"selected\");\r\n                parent_list.find(\".checkItem\").prop(\"checked\", true);\r\n                \r\n            }\r\n        }else{\r\n                var count = 0;\r\n                item.toggleClass(\"selected\");\r\n                parent_items.not(parent_items.eq(0)).each(function(){\r\n                    if ($(this).is(\".selected\") == false){\r\n                        count++;\r\n                    }\r\n                });\r\n                if(count != 0){\r\n                    parent_items.eq(0).removeClass(\"selected\");\r\n                    parent_items.eq(0).find(\".checkItem\").prop(\"checked\", false);\r\n                }else{\r\n                    parent_items.eq(0).addClass(\"selected\");\r\n                    parent_items.eq(0).find(\".checkItem\").prop(\"checked\", true);\r\n                }\r\n            if (parent_items.is(\".selected\") != true && parent_items.find(\"input\").prop('checked') !=true){\r\n                parent.removeAttr('style');\r\n                // parent_input.val(def_value[parent_num]);\r\n                // parent_text.html(def_value[parent_num]);\r\n            }\r\n            if (parent_items.not(parent_items.eq(0)).is(\".selected\") == false){\r\n                parent_items.eq(0).removeClass(\"selected\");\r\n                parent_items.eq(0).find(\".checkItem\").prop(\"checked\", false);\r\n                parent.removeAttr('style');\r\n            }\r\n        }\r\n        /* появление выбранных полей под филтором */\r\n        $(\".selected-fields\").removeClass(\"hide\");\r\n        var fields_span=[],\r\n            _this_span = _this.closest(\"li\").find(\"span\"),\r\n            name_field_text = parent_text.text(),\r\n            clone_this_span,\r\n            new_field;\r\n        if (item.is(\".allItem\")){\r\n            for (var j = 1; j < parent_items.length;j++){\r\n                fields_span[j - 1] = parent_items.eq(j).find(\"span\").clone();\r\n\r\n            }\r\n            if (all_item.is(\".selected\")){\r\n                for (var j = 0; j < fields_span.length;j++){\r\n                    item_index = j + 1;\r\n                    new_field = \"<div class='selected-field'><p>\" + name_field_text + \"</p><div><span>\" + fields_span[j].html() + \"</span><i class='close icon-1-4_close'></i></div><b>\" + filterItem_index + \"</b><em>\" + item_index + \"</em></div>\";\r\n                    $(\".selected-fields\").append(new_field);\r\n                }\r\n            }else{\r\n                for (var j = 0; j < fields_span.length; j++){\r\n                    $(\".selected-field\").each(function () {\r\n                        if ($(this).find(\"p\").html() == name_field_text && $(this).find(\"span\").html() == fields_span[j].html()) {\r\n                            $(this).remove();\r\n                        }\r\n                    });\r\n                    if ($(\".selected-field\").length == 0) {\r\n                        $(\".selected-fields\").addClass(\"hide\");\r\n                    }\r\n                }\r\n            }\r\n        }else{\r\n            clone_this_span = _this_span.clone();\r\n            new_field = \"<div class='selected-field'><p>\" + name_field_text + \"</p><div><span>\" + clone_this_span.html() + \"</span><i class='close icon-1-4_close'></i></div><b>\" + filterItem_index + \"</b><em>\" + item_index + \"</em></div>\";\r\n            if(item.is(\".selected\")){\r\n                $(\".selected-fields\").append(new_field);\r\n            }else{\r\n                $(\".selected-field\").each(function(){\r\n                    if ($(this).find(\"p\").html() == name_field_text && $(this).find(\"span\").html() == _this_span.html()){\r\n                        $(this).remove();\r\n                    }\r\n                });\r\n                if ($(\".selected-field\").length == 0) {\r\n                    $(\".selected-fields\").addClass(\"hide\");\r\n                }\r\n            }\r\n        }\r\n\r\n    });\r\n\r\n    /* удаление выбранных элементов */\r\n    $(document).on('click', '.selected-field .close', function () {\r\n        var _this= $(this),\r\n            filterItem_index = _this.closest(\".selected-field\").find(\"b\").text(),\r\n            filterItem_li_index = _this.closest(\".selected-field\").find(\"em\").text();\r\n\r\n        $(\".filterItem\").eq(filterItem_index).find(\"li\").eq(filterItem_li_index).removeClass(\"selected\");\r\n        $(\".filterItem\").eq(filterItem_index).find(\" li\").eq(filterItem_li_index).find(\".checkItem\").prop('checked', false);\r\n\r\n        $(this).closest(\".selected-field\").remove()\r\n        if ($(\".selected-field\").length == 0) {\r\n            $(\".selected-fields\").addClass(\"hide\");\r\n        }\r\n        var count = 0;\r\n        if ($(\".filterItem\").eq(filterItem_index).find(\"li\").eq(0).is(\".selected\")){\r\n            $(\".filterItem\").eq(filterItem_index).find(\"li\").each(function(){\r\n                if ($(this).is(\".selected\")){\r\n                    count++;\r\n                }\r\n            });\r\n            if(count == 1 ){\r\n                $(\".filterItem\").eq(filterItem_index).find(\"li\").eq(0).removeClass(\"selected\");\r\n                $(\".filterItem\").eq(filterItem_index).find(\"li\").eq(0).find(\".checkItem\").prop('checked', false);\r\n                $(\".filterItem\").eq(filterItem_index).find(\".select-text\").removeAttr('style');\r\n            }\r\n        }\r\n    });\r\n\r\n    $(document).on('click',function(){\r\n        $(\".select-wrap\").removeClass(\"open\");\r\n    });\r\n    $(document).on('click', '.select-wrap', function(e){\r\n        e.stopPropagation();\r\n    });\r\n\r\n    $(document).on('click', '.radioItem', function(){\r\n        var list_body_name = $(this).closest(\"ul\").attr(\"data-name\"),\r\n            parent = $(this).closest(\".select-wrap\"),\r\n            parent_input = $(this).closest(\".select-wrap\").find(\".select-text input\"),\r\n            parent_text = $(this).closest(\".select-wrap\").find(\".select-text span\"),\r\n            _this = $(this),\r\n            item = _this.closest(\"li\");\r\n\r\n            $(\".dropdown ul\").each(function () {\r\n                if ($(this).attr(\"data-name\") == list_body_name) {\r\n                    parent_list = $(this);\r\n                    parent_items = parent_list.children(\"li\");\r\n                }\r\n            });\r\n        parent_items.removeClass(\"selected\");\r\n        item.addClass(\"selected\");\r\n        parent_input.val(_this.val());\r\n        parent_text.text(_this.next().text());\r\n        parent.removeClass(\"open\");\r\n    });\r\n\r\n    $(\".select-wrap\").each(function(){\r\n    /* убераем стрелочки */\r\n        var selectText = $(this).find('.select-text')\r\n        if (selectText.find(\"input\").attr(\"type\") != \"hidden\" && selectText.next().is(\".dropdown\") == false){\r\n            $(this).addClass(\"Notarrow\");\r\n        }\r\n    });\r\n    /* раскрытие и скрытие элементов фильтра */\r\n    var len_filterItem = $(\".filterItem\").length;\r\n    for(var i=0;i<8;i++){\r\n        $(\".filterItem\").eq(i).addClass(\"show\");\r\n    }\r\n    $(document).on('click', '.Btn-filter', function(){\r\n        for (var i = 8; i < len_filterItem; i++) {\r\n            $(\".filterItem\").eq(i).toggleClass(\"show\", 1000);\r\n        }\r\n    });\r\n\r\n    var f= 0;\r\n    $(\".filter-Btn\").click(function(){\r\n        f++;\r\n        switch(f % 2){\r\n            case 0: \r\n                $(\".filter-Btn\").find(\"span\").text(\"Открыть фильтры\");\r\n                break;\r\n            default:\r\n                $(\".filter-Btn\").find(\"span\").text(\"Скрыть фильтры\");\r\n                break;\r\n        }\r\n        $(this).closest(\".filter-wrap\").find(\".filter-inner\").slideToggle(\"slow\");\r\n    });\r\n\r\n\r\n\r\n});"],"file":"../../../../templates/blocks/filter/filter.js"}